<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/108/three.min.js"></script>
    <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script src="https://jyunming-chen.github.io/tutsplus/js/KeyboardState.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bubbly-bg@1.0.0/dist/bubbly-bg.js"></script>
    <script>
    bubbly({
      blur:15,
      colorStart: '#48c6ef',
      colorStop: '#6f86d6',
      radiusFunc:() => 1 + Math.random() * 15,
      angleFunc:() => -Math.PI / 2,
      velocityFunc:() => Math.random() * 2.5,
      bubbleFunc:() => `hsla(${200 + Math.random() * 50}, 100%, 65%, .1)`,
      bubbles: 120
    });
    /*bubbly({
        colorStart: "#48c6ef",
        colorStop: "#6f86d6",
        blur: 2,
        compose: "source-over",
        shadowColor: "#fff",
    });*/
    </script>
    <style>
    #info {
      position: absolute;
      bottom: 5px;
      width: 100%;
      padding: 10px;
      text-align: center;
      color: #ffffff
    }

    #ti {
      position: absolute;
      top: 0px;
      width: 100%;
      padding: 10px;
      text-align: center;
      color: #ffffff
    }

    body {
      background-image: linear-gradient(to top, #7DE2FC 0%, #B9B6E5 100%);
      margin: 0px;
      overflow: hidden;
      /*background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);*/
      /*background-image: linear-gradient(to top, #30cfd0 0%, #330867 100%);*/
    }

    button {
      border: none;
      color: white;
      background-color: Transparent;
      border-radius: 8px;
      transition-duration: 0.4s;
      /* Safari */
      transition-duration: 0.4s;
      border: 1px solid #ffffff;
    }

    button:hover {
      border: 1px solid #96B9F2;
      background-color: Transparent;
      color: white;
      box-shadow: 0 5px 20px 0 rgba( 0, 0, 0, 0.54), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
    }

    </style>
</head>
<body>
  <div id="ti">HS dance</div>
  <div id="info">2015-1018-00 composed by Snowmint<br>
    <button id="play" style="width:20%">Pause</button>
    <br><br>
  </div><br>
  <audio id="soundtrack" autoplay loop style="display:none">
  <source src="https://raw.githubusercontent.com/snowmint/gameProgram/master/bgm/1018-00.mp3" type='audio/mp3'>
  </audio>
</body>
<script>
$('#play').click(function() {
  isPaused = !isPaused;
  if (isPaused) {
    $('#play').text('Play')
    soundTrack.pause()
  } else {
    $('#play').text('Pause')
    soundTrack.play()
  }
});

function toggle() {
  isDimming = !isDimming;
  sign = isDimming ? -1 : 1;
  console.log(isDimming);
}

//about sound
var collisionSound, collisionSoundWall, soundTrack;
var isDimming = false,
  soundVal = 1.0,
  sign = 1.0;
var isPaused = false;
//about sound end
var camera, scene, renderer, controls;
var keyboard = new KeyboardState();
var theta = 0
var parts;
var high = 17
var gcontrols; // for dat-gui
var speed = 10 //7 recommand
var intI = speed;


init();
animate();

function init() {

  soundTrack = document.getElementById('soundtrack');
  soundTrack.volume = 0.7;

  scene = new THREE.Scene();

  camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
  camera.position.y = 40;
  camera.position.z = 120;
  scene.add(camera);

  light = new THREE.PointLight(0x474747);
  light.position.set(0, 50, 0);
  scene.add(light);
  let AbLight = new THREE.AmbientLight(0xbbbbbb); // soft white light
  AbLight.position.set(0, 100, 0);
  scene.add(AbLight);

  var gridXZ = new THREE.GridHelper(200, 20, 'red', 'white');
  scene.add(gridXZ);

  renderer = new THREE.WebGLRenderer();
  renderer = new THREE.WebGLRenderer({
    alpha: true
  });
  renderer.setSize(window.innerWidth, window.innerHeight);


  controls = new THREE.OrbitControls(camera, renderer.domElement);

  document.body.appendChild(renderer.domElement);
  window.addEventListener('resize', onWindowResize, true);
  ////////////////////////////////////////////////////////////////////////
  parts = buildPart()

  scene.add(parts[0])
  parts[0].add(parts[1])

  parts[1].position.set(3.5, 14, 0)
  parts[1].rotation.z = -Math.PI / 2
  parts[1].rotation.z += 0.5
  parts[1].rotation.order = 'ZYX'

  parts[0].add(parts[2])

  parts[2].position.set(-3.5, 14, 0)
  parts[2].rotation.z = -Math.PI / 2
  parts[2].rotation.z -= 0.5
  parts[2].rotation.order = 'ZYX'

  parts[1].add(parts[3])
  parts[3].position.set(6, 0, 0)
  parts[3].rotation.order = 'ZYX'

  parts[2].add(parts[4])
  parts[4].position.set(6, 0, 0)
  parts[4].rotation.order = 'ZYX'

  parts[0].add(parts[5])

  parts[5].position.set(2.5, 0, 0)
  parts[5].rotation.z = -Math.PI / 2
  parts[5].rotation.order = 'ZYX'

  parts[0].add(parts[6])

  parts[6].position.set(-2.5, 0, 0)
  parts[6].rotation.z = -Math.PI / 2
  parts[6].rotation.order = 'ZYX'

  parts[5].add(parts[7])
  parts[7].position.set(6, 0, 0)
  parts[7].rotation.order = 'ZYX'

  parts[6].add(parts[8])
  parts[8].position.set(6, 0, 0)
  parts[8].rotation.order = 'ZYX'

  ///////////////////////////////
  gcontrol = { //new function()
    P_high: 0.01,
    P_X: 0.01,
    body_x: 0.01,
    body_y: 0.01,
    body_z: 0.01,
    leftUpArm_x: 0.01,
    leftUpArm_y: 0.01,
    leftUpArm_z: 0.01,
    leftArm_x: 0.01,
    leftArm_y: 0.01,
    leftArm_z: 0.01,
    rightUpArm_x: 0.01,
    rightUpArm_y: 0.01,
    rightUpArm_z: 0.01,
    rightArm_x: 0.01,
    rightArm_y: 0.01,
    rightArm_z: 0.01,
    leftUpLeg_x: 0.01,
    leftUpLeg_y: 0.01,
    leftUpLeg_z: 0.01,
    leftLeg_x: 0.01,
    leftLeg_y: 0.01,
    leftLeg_z: 0.01,
    rightUpLeg_x: 0.01,
    rightUpLeg_y: 0.01,
    rightUpLeg_z: 0.01,
    rightLeg_x: 0.01,
    rightLeg_y: 0.01,
    rightLeg_z: 0.01,
    /*
    this.body_x = 0.01;
    this.body_y = 0.01;
    this.body_z = 0.01;
    this.leftUpArm_x = 0.01;
    this.leftUpArm_y = 0.01;
    this.leftUpArm_z = 0.01;
    this.leftArm_x = 0.01;
    this.leftArm_y = 0.01;
    this.leftArm_z = 0.01;
    this.rightUpArm_x = 0.01;
    this.rightUpArm_y = 0.01;
    this.rightUpArm_z = 0.01;
    this.rightArm_x = 0.01;
    this.rightArm_y = 0.01;
    this.rightArm_z = 0.01;
    this.leftUpLeg_x = 0.01;
    this.leftUpLeg_y = 0.01;
    this.leftUpLeg_z = 0.01;
    this.leftLeg_x = 0.01;
    this.leftLeg_y = 0.01;
    this.leftLeg_z = 0.01;
    this.rightUpLeg_x = 0.01;
    this.rightUpLeg_y = 0.01;
    this.rightUpLeg_z = 0.01;
    this.rightLeg_x = 0.01;
    this.rightLeg_y = 0.01;
    this.rightLeg_z = 0.0;*/
  };

  Gmovements = {
    body_x: 0.01,
    body_y: 0.01,
    body_z: 0.01,
    leftUpArm_x: 0.01,
    leftUpArm_y: 0.01,
    leftUpArm_z: 0.01,
    leftArm_x: 0.01,
    leftArm_y: 0.01,
    leftArm_z: 0.01,
    rightUpArm_x: 0.01,
    rightUpArm_y: 0.01,
    rightUpArm_z: 0.01,
    rightArm_x: 0.01,
    rightArm_y: 0.01,
    rightArm_z: 0.01,
    leftUpLeg_x: 0.01,
    leftUpLeg_y: 0.01,
    leftUpLeg_z: 0.01,
    leftLeg_x: 0.01,
    leftLeg_y: 0.01,
    leftLeg_z: 0.01,
    rightUpLeg_x: 0.01,
    rightUpLeg_y: 0.01,
    rightUpLeg_z: 0.01,
    rightLeg_x: 0.01,
    rightLeg_y: 0.01,
    rightLeg_z: 0.01,
  };

  var gui = new dat.GUI({
    load: loadJSON(),
    preset: 'key1'
  });
  gui.domElement.id = 'gui';
  gui.remember(gcontrol);

  var people_pos = gui.addFolder('people');
  people_pos.add(gcontrol, 'P_high', 0.01, 30);
  people_pos.add(gcontrol, 'P_X', -50.0, 50.0);
  var body_pos = gui.addFolder('body');
  body_pos.add(gcontrol, 'body_x', 0.01, 6.25);
  body_pos.add(gcontrol, 'body_y', 0.01, 6.25);
  body_pos.add(gcontrol, 'body_z', 0.01, 6.25);
  var leftArm_pos = gui.addFolder('leftArm');
  leftArm_pos.add(gcontrol, 'leftUpArm_x', 0.01, 6.25);
  leftArm_pos.add(gcontrol, 'leftUpArm_y', 0.01, 6.25);
  leftArm_pos.add(gcontrol, 'leftUpArm_z', 0.01, 6.25);
  leftArm_pos.add(gcontrol, 'leftArm_x', 0.01, 6.25);
  leftArm_pos.add(gcontrol, 'leftArm_y', 0.01, 6.25);
  leftArm_pos.add(gcontrol, 'leftArm_z', 0.01, 6.25);
  var rightArm_pos = gui.addFolder('rightArm');
  rightArm_pos.add(gcontrol, 'rightUpArm_x', 0.01, 6.25);
  rightArm_pos.add(gcontrol, 'rightUpArm_y', 0.01, 6.25);
  rightArm_pos.add(gcontrol, 'rightUpArm_z', 0.01, 6.25);
  rightArm_pos.add(gcontrol, 'rightArm_x', 0.01, 6.25);
  rightArm_pos.add(gcontrol, 'rightArm_y', 0.01, 6.25);
  rightArm_pos.add(gcontrol, 'rightArm_z', 0.01, 6.25);
  var leftLeg_pos = gui.addFolder('leftLeg');
  leftLeg_pos.add(gcontrol, 'leftUpLeg_x', 0.01, 6.25);
  leftLeg_pos.add(gcontrol, 'leftUpLeg_y', 0.01, 6.25);
  leftLeg_pos.add(gcontrol, 'leftUpLeg_z', 0.01, 6.25);
  leftLeg_pos.add(gcontrol, 'leftLeg_x', 0.01, 6.25);
  leftLeg_pos.add(gcontrol, 'leftLeg_y', 0.01, 6.25);
  leftLeg_pos.add(gcontrol, 'leftLeg_z', 0.01, 6.25);
  var rightLeg_pos = gui.addFolder('rightLeg');
  rightLeg_pos.add(gcontrol, 'rightUpLeg_x', 0.01, 6.25);
  rightLeg_pos.add(gcontrol, 'rightUpLeg_y', 0.01, 6.25);
  rightLeg_pos.add(gcontrol, 'rightUpLeg_z', 0.01, 6.25);
  rightLeg_pos.add(gcontrol, 'rightLeg_x', 0.01, 6.25);
  rightLeg_pos.add(gcontrol, 'rightLeg_y', 0.01, 6.25);
  rightLeg_pos.add(gcontrol, 'rightLeg_z', 0.01, 6.25);

  /////////////////////////////////////
}

function loadJSON() {
  return {
    "preset": "key1",
    "remembered": {
        "key1": {
          "0": {
            "P_high": 17,
            "P_X": 0,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 5.000594198817236,
            "leftArm_x": 0.01,
            "leftArm_y": 0.01,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.01,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.15058011827654189,
            "rightArm_z": 0.22087017741481282,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 0.01,
            "leftUpLeg_z": 4.8,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.01,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.01,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.04,
            "rightLeg_z": 6.25
          }
        },
        "key2": {
          "0": {
            "P_high": 17,
            "P_X": 0,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.29116023655308376,
            "leftUpArm_z": 5.000594198817236,
            "leftArm_x": 0.01,
            "leftArm_y": 0.43174035482962564,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 6.054945085891299,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.15058011827654189,
            "rightArm_z": 0.22087017741481282,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.773784849338216,
            "leftUpLeg_z": 4.8,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.7129005913827092,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.01,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.04,
            "rightLeg_z": 6.25
          }
        },
        "key3": {
          "0": {
            "P_high": 17,
            "P_X": -0.9377640101379825,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.29116023655308376,
            "leftUpArm_z": 5.000594198817236,
            "leftArm_x": 0.01,
            "leftArm_y": 0.01,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 5.914364967614758,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.29116023655308376,
            "rightArm_z": 0.01,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.914364967614758,
            "leftUpLeg_z": 4.789724021402423,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.7129005913827092,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.08029005913827093,
            "rightUpLeg_z": 4.719433962264152,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.04,
            "rightLeg_z": 6.25
          }
        },
        "key4": {
          "0": {
            "P_high": 17,
            "P_X": -2.2894959166431903,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.29116023655308376,
            "leftUpArm_z": 5.000594198817236,
            "leftArm_x": 0.01,
            "leftArm_y": 0.01,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 5.914364967614758,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.29116023655308376,
            "rightArm_z": 0.01,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.492624612785132,
            "leftUpLeg_z": 4.789724021402423,
            "leftLeg_x": 0.01,
            "leftLeg_y": 1.2752210644888766,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.22087017741481282,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.04,
            "rightLeg_z": 6.25
          }
        },
        "key5": {//TODO
          "0": {
            "P_high": 17,
            "P_X": -3.2894959166431903,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.29116023655308376,
            "leftUpArm_z": 5.030594198817236,
            "leftArm_x": 0.01,
            "leftArm_y": 0.01,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 5.914364967614758,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.35116023655308376,
            "rightArm_z": 0.01,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.492624612785132,
            "leftUpLeg_z": 4.789724021402423,
            "leftLeg_x": 0.01,
            "leftLeg_y": 1.0752210644888766,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.22087017741481282,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.125,
            "rightLeg_z": 6.25
          }
        },
        "key6": {
          "0": {
            "P_high": 17,
            "P_X": -4.317093776401009,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.29116023655308376,
            "leftUpArm_z": 5.070884257955506,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678965,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 6.25,
            "rightUpArm_z": 4.50856378484934,
            "rightArm_x": 0.01,
            "rightArm_y": 0.43174035482962564,
            "rightArm_z": 0.01,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.492624612785132,
            "leftUpLeg_z": 4.789724021402423,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.8534807096592513,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.22087017741481282,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.29116023655308376,
            "rightLeg_z": 6.25
          }
        },
        "key7": {
          "0": {
            "P_high": 17,
            "P_X": -7.020557589411428,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.08029005913827093,
            "leftUpArm_z": 5.070884257955506,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678965,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.29116023655308376,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.5723204731061675,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.7034947901999455,
            "leftUpLeg_z": 4.789724021402423,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.8534807096592513,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.29116023655308376,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.5020304139678965,
            "rightLeg_z": 6.25
          }
        },
        "key8": {
          "0": {
            "P_high": 16.225375950436504,
            "P_X": -7.020557589411428,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.29116023655308376,
            "leftUpArm_z": 5.070884257955506,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678965,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.43174035482962564,
            "rightUpArm_z": 4.438273725711068,
            "rightArm_x": 0.01,
            "rightArm_y": 0.5723204731061675,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.7034947901999455,
            "leftUpLeg_z": 4.789724021402423,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.8534807096592513,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 0.01,
            "rightUpLeg_z": 4.7,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.5020304139678965,
            "rightLeg_z": 6.25
          }
        },
        "key9": {
          "0": {
            "P_high": 16.225375950436504,
            "P_X": -8.092087124345163,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.01,
            "leftUpArm_z": 5.070884257955506,
            "leftArm_x": 0.01,
            "leftArm_y": 0.14763440860215063,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.22087017741481252,
            "rightUpArm_z": 4.41430107526882,
            "rightArm_x": 0.01,
            "rightArm_y": 0.22087017741481252,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.997096774193552,
            "leftUpLeg_z": 4.827204301075271,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.4229032258064518,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 6.195525204167842,
            "rightUpLeg_z": 4.689569892473121,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.15058011827654189,
            "rightLeg_z": 6.25
          }
        },
        "key10": {
          "0": {
            "P_high": 16.225375950436504,
            "P_X": -10.574486060264753,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 5.070884257955506,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678958,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.36145029569135423,
            "rightUpArm_z": 4.41430107526882,
            "rightArm_x": 0.01,
            "rightArm_y": 0.22087017741481252,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 6.25,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.22087017741481252,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 5.7034947901999375,
            "rightUpLeg_z": 4.689569892473121,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.5020304139678958,
            "rightLeg_z": 6.25
          }
        },
        "key11": {
          "0": {
            "P_high": 16.225375950436504,
            "P_X": -12.827372571106771,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 5.070884257955506,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678958,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.36145029569135423,
            "rightUpArm_z": 4.41430107526882,
            "rightArm_x": 0.01,
            "rightArm_y": 0.22087017741481252,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 0.1505801182765417,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.22087017741481252,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 5.91436496761475,
            "rightUpLeg_z": 4.689569892473121,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.7831906505209792,
            "rightLeg_z": 6.25
          }
        },
        "key12": {
          "0": {
            "P_high": 16.56319628273724,
            "P_X": -12.827372571106771,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 4.930304139678959,
            "leftArm_x": 0.01,
            "leftArm_y": 0.85348070965925,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.36145029569135423,
            "rightUpArm_z": 4.508563784849334,
            "rightArm_x": 0.01,
            "rightArm_y": 1.0643508870740626,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 0.08029005913827084,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.36145029569135423,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 5.91436496761475,
            "rightUpLeg_z": 4.689569892473121,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.85348070965925,
            "rightLeg_z": 6.25
          }
        },
        "key13": {
          "0": {
            "P_high": 18.92793860884256,
            "P_X": -13.95381582652778,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 4.930304139678959,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678958,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.36145029569135423,
            "rightUpArm_z": 4.508563784849334,
            "rightArm_x": 0.01,
            "rightArm_y": 0.6426105322444375,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 0.08029005913827084,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.01,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 6.25,
            "rightUpLeg_z": 4.719433962264146,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.43174035482962503,
            "rightLeg_z": 6.25
          }
        },
        "key14": {
          "0": {
            "P_high": 19.94139960574484,
            "P_X": -15.080259081948782,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 4.930304139678959,
            "leftArm_x": 0.01,
            "leftArm_y": 0.01,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.36145029569135423,
            "rightUpArm_z": 4.508563784849334,
            "rightArm_x": 0.01,
            "rightArm_y": 0.5020304139678958,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 6.25,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.5020304139678958,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 6.25,
            "rightUpLeg_z": 4.719433962264146,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.36145029569135423,
            "rightLeg_z": 6.25
          }
        },
        "key15": {
          "0": {
            "P_high": 18.5901182765418,
            "P_X": -15.080259081948782,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 6.25,
            "leftUpArm_z": 4.930304139678959,
            "leftArm_x": 0.01,
            "leftArm_y": 0.5020304139678958,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.36145029569135423,
            "rightUpArm_z": 4.508563784849334,
            "rightArm_x": 0.01,
            "rightArm_y": 0.7831906505209792,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.91436496761475,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.85348070965925,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 6.25,
            "rightUpLeg_z": 4.719433962264146,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.36145029569135423,
            "rightLeg_z": 6.25
          }
        },
        "key16": {
          "0": {
            "P_high": 17.23883694733876,
            "P_X": -15.080259081948782,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.2911602365530834,
            "leftUpArm_z": 4.930304139678959,
            "leftArm_x": 0.01,
            "leftArm_y": 0.2911602365530834,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.22087017741481252,
            "rightUpArm_z": 4.508563784849334,
            "rightArm_x": 0.01,
            "rightArm_y": 0.7831906505209792,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.773784849338209,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.6426105322444375,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 6.25,
            "rightUpLeg_z": 4.719433962264146,
            "rightLeg_x": 0.04,
            "rightLeg_y": 0.36145029569135423,
            "rightLeg_z": 6.25
          }
        },
        "key17": {
          "0": {
            "P_high": 16.22537595043648,
            "P_X": -17.333145592790792,
            "body_x": 0.01,
            "body_y": 4.8,
            "body_z": 0.01,
            "leftUpArm_x": 3.38,
            "leftUpArm_y": 0.5020304139678958,
            "leftUpArm_z": 4.930304139678959,
            "leftArm_x": 0.01,
            "leftArm_y": 0.7831906505209792,
            "leftArm_z": 6.125235145029571,
            "rightUpArm_x": 3.2433427203604626,
            "rightUpArm_y": 0.01,
            "rightUpArm_z": 4.508563784849334,
            "rightArm_x": 0.01,
            "rightArm_y": 0.7129005913827084,
            "rightArm_z": 0.15058011827654189,
            "leftUpLeg_x": 0.01,
            "leftUpLeg_y": 5.7034947901999375,
            "leftUpLeg_z": 4.789724021402417,
            "leftLeg_x": 0.01,
            "leftLeg_y": 0.6426105322444375,
            "leftLeg_z": 6.25,
            "rightUpLeg_x": 0.1,
            "rightUpLeg_y": 6.054945085891292,
            "rightUpLeg_z": 4.719433962264146,
            "rightLeg_x": 0.04,
            "rightLeg_y": 1.0643508870740626,
            "rightLeg_z": 6.25
          }
        },
    },
    "closed": false,
      "folders": {
        "people": {
          "preset": "Default",
          "closed": false,
          "folders": {}
        },
        "body": {
          "preset": "Default",
          "closed": true,
          "folders": {}
        },
        "leftArm": {
          "preset": "Default",
          "closed": false,
          "folders": {}
        },
        "rightArm": {
          "preset": "Default",
          "closed": false,
          "folders": {}
        },
        "leftLeg": {
          "preset": "Default",
          "closed": false,
          "folders": {}
        },
        "rightLeg": {
          "preset": "Default",
          "closed": false,
          "folders": {}
        }
     }
  }
}

function onWindowResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}

function buildPart(colorName = 'white') {
  let body = new THREE.Object3D();
  var Cgeometry = new THREE.CylinderGeometry(2, 7, 15, 32);
  let normalMat = new THREE.MeshNormalMaterial({
    color: colorName,
    transparent: true,
    opacity: 0.64
  });
  let smilefaceMat = new THREE.MeshPhongMaterial(
  {
    color:0xffffff,
    map: THREE.ImageUtils.loadTexture('marshmellow.png')
  });
  let skinMat = new THREE.MeshPhongMaterial(
  {
    color:0xffffff,
    map: THREE.ImageUtils.loadTexture('skin.jpg')
  });
  
  let skirtMat = new THREE.MeshPhongMaterial(
  {
    color:0xffffff,
    map: THREE.ImageUtils.loadTexture('skirt_texture_short.png')
  });
    
  var upbodyGeo = new THREE.CylinderGeometry(3, 2.5, 5, 32);
  var material = new THREE.MeshPhongMaterial({color: 0xF7FE2E}); 
  var wholeBody = new THREE.Mesh(upbodyGeo, skirtMat);
  wholeBody.position.y = 7;
    
  var donwbodyGeo = new THREE.CylinderGeometry(2.5, 7, 10, 32);
  wholeBody.updateMatrix();
  donwbodyGeo.merge(wholeBody.geometry, wholeBody.matrix);
  
    
  let bodyMesh = new THREE.Mesh(donwbodyGeo, skirtMat)
  let body_shL = new THREE.Mesh(new THREE.SphereGeometry(2, 32, 32), skirtMat)
  let body_shR = new THREE.Mesh(new THREE.SphereGeometry(2, 32, 32), skirtMat)
  let headMesh = new THREE.Mesh(new THREE.SphereGeometry(3.5, 32, 32), smilefaceMat)
  let neckMesh = new THREE.Mesh(new THREE.CylinderGeometry(1, 2, 2, 32), skinMat)

  body.add(headMesh)
  body.add(neckMesh)
  body.add(bodyMesh)
  body.add(body_shL)
  body.add(body_shR)
  headMesh.rotation.y = 6*Math.PI/4
  headMesh.position.y = 19 // + high
  neckMesh.position.y = 15 // + high
  bodyMesh.position.y = 5.5 //+ high
  body_shL.position.x = 3
  body_shL.position.y = 13.5 //+ high
  body_shR.position.x = -3
  body_shR.position.y = 13.5 //+ high
  axis = new THREE.AxisHelper(5)
  body.add(axis)



  let leftUpperArm = new THREE.Object3D()
  upperArmMesh = new THREE.Mesh(new THREE.BoxGeometry(7, 1.5, 1.5), skinMat)
  leftUpperArmjointMesh = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), skinMat)
  leftUpperArm.add(upperArmMesh)
  leftUpperArm.add(leftUpperArmjointMesh)
  leftUpperArmjointMesh.position.x = 6
  upperArmMesh.position.x = 3
  leftUpperArm.add(new THREE.AxisHelper(5))
  body.add(leftUpperArm);

  let leftArm = new THREE.Object3D()
  ArmMesh = new THREE.Mesh(new THREE.BoxGeometry(8, 1, 1), skinMat)
  leftArmjointMesh = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), skinMat)
  leftArm.add(ArmMesh)
  leftArm.add(leftArmjointMesh)
  leftArmjointMesh.position.x = 8
  ArmMesh.position.x = 4
  leftArm.add(new THREE.AxisHelper(5))

  let rightUpperArm = new THREE.Object3D()
  rightUpperArmMesh = new THREE.Mesh(new THREE.BoxGeometry(7, 1.5, 1.5), skinMat)
  rightUpperArmjointMesh = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), skinMat)
  rightUpperArm.add(rightUpperArmMesh)
  rightUpperArm.add(rightUpperArmjointMesh)
  rightUpperArmjointMesh.position.x = 6
  rightUpperArmMesh.position.x = 3
  rightUpperArm.add(new THREE.AxisHelper(-5))
  body.add(rightUpperArm);

  let rightArm = new THREE.Object3D()
  ArmMesh = new THREE.Mesh(new THREE.BoxGeometry(8, 1, 1), skinMat)
  rightArmjointMesh = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), skinMat)
  rightArm.add(ArmMesh)
  rightArm.add(rightArmjointMesh)
  rightArmjointMesh.position.x = 8
  ArmMesh.position.x = 4
  rightArm.add(new THREE.AxisHelper(-5))

  let leftUpperLeg = new THREE.Object3D()
  upperLegMesh = new THREE.Mesh(new THREE.BoxGeometry(10, 2, 2), skinMat)
  leftUpperLegjointMesh = new THREE.Mesh(new THREE.SphereGeometry(1.3, 32, 32), skinMat)
  leftUpperLeg.add(leftUpperLegjointMesh)
  leftUpperLegjointMesh.position.x = 7
  leftUpperLeg.add(upperLegMesh)
  upperLegMesh.position.x = 1.5
  leftUpperLeg.add(new THREE.AxisHelper(5))

  let leftLeg = new THREE.Object3D()
  LegMesh = new THREE.Mesh(new THREE.BoxGeometry(10, 1.5, 1.5), skinMat)
  leftLegjointMesh = new THREE.Mesh(new THREE.BoxGeometry(1.5, 2, 5), skirtMat)
  leftLeg.add(leftLegjointMesh)
  leftLegjointMesh.position.x = 10
  leftLegjointMesh.position.z = 2
  leftLegJMesh = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), skirtMat)
  leftLeg.add(leftLegJMesh)
  leftLegJMesh.position.x = 10
  leftLeg.add(LegMesh)
  LegMesh.position.x = 5
  leftLeg.add(new THREE.AxisHelper(5))

  let rightUpperLeg = new THREE.Object3D()
  upperLegMesh = new THREE.Mesh(new THREE.BoxGeometry(10, 2, 2), skinMat)
  rightUpperLegjointMesh = new THREE.Mesh(new THREE.SphereGeometry(1.3, 32, 32), skinMat)
  rightUpperLeg.add(rightUpperLegjointMesh)
  rightUpperLegjointMesh.position.x = 7
  rightUpperLeg.add(upperLegMesh)
  upperLegMesh.position.x = 1.5
  rightUpperLeg.add(new THREE.AxisHelper(-5))

  let rightLeg = new THREE.Object3D()
  LegMesh = new THREE.Mesh(new THREE.BoxGeometry(10, 1.5, 1.5), skinMat)
  rightLegjointMesh = new THREE.Mesh(new THREE.BoxGeometry(1.5, 2, 5), skirtMat)
  rightLeg.add(rightLegjointMesh)
  rightLegjointMesh.position.x = 10
  rightLegjointMesh.position.z = 2
  rightLegJMesh = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), skirtMat)
  rightLeg.add(rightLegJMesh)
  rightLegJMesh.position.x = 10
  rightLeg.add(LegMesh)
  LegMesh.position.x = 5
  rightLeg.add(new THREE.AxisHelper(-5))

  return [body, leftUpperArm, rightUpperArm, leftArm, rightArm, leftUpperLeg, rightUpperLeg, leftLeg, rightLeg];
}

function sleep(milliseconds) {
  var start = new Date().getTime();
  while (1)
    if ((new Date().getTime() - start) > milliseconds) break;
}

function animate() {

  /*//for animation

  let d = Math.floor(intI / speed);
  var move = loadJSON().remembered['key' + d];

  parts[0].position.y = move[0].P_high;
  parts[0].position.x = move[0].P_X;

  parts[0].rotation.x = move[0].body_x;
  parts[0].rotation.y = move[0].body_y;
  parts[0].rotation.z = move[0].body_z;

  parts[1].rotation.x = move[0].leftUpArm_x;
  parts[1].rotation.y = move[0].leftUpArm_y;
  parts[1].rotation.z = move[0].leftUpArm_z;

  parts[2].rotation.x = move[0].rightUpArm_x;
  parts[2].rotation.y = move[0].rightUpArm_y;
  parts[2].rotation.z = move[0].rightUpArm_z;

  parts[3].rotation.x = move[0].leftArm_x;
  parts[3].rotation.y = move[0].leftArm_y;
  parts[3].rotation.z = move[0].leftArm_z;

  parts[4].rotation.x = move[0].rightArm_x;
  parts[4].rotation.y = move[0].rightArm_y;
  parts[4].rotation.z = move[0].rightArm_z;

  parts[5].rotation.x = move[0].leftUpLeg_x;
  parts[5].rotation.y = move[0].leftUpLeg_y;
  parts[5].rotation.z = move[0].leftUpLeg_z;

  parts[6].rotation.x = move[0].rightUpLeg_x;
  parts[6].rotation.y = move[0].rightUpLeg_y;
  parts[6].rotation.z = move[0].rightUpLeg_z;

  parts[7].rotation.x = move[0].leftLeg_x;
  parts[7].rotation.y = move[0].leftLeg_y;
  parts[7].rotation.z = move[0].leftLeg_z;

  parts[8].rotation.x = move[0].rightLeg_x;
  parts[8].rotation.y = move[0].rightLeg_y;
  parts[8].rotation.z = move[0].rightLeg_z;

  if (intI >= 9 * speed + (speed - 1)) intI = speed;
  else intI += 1;

  //*/
  ///*//for gui control
  parts[0].position.y = gcontrol.P_high;
  parts[0].position.x = gcontrol.P_X;

  parts[0].rotation.x = gcontrol.body_x;
  parts[0].rotation.y = gcontrol.body_y;
  parts[0].rotation.z = gcontrol.body_z;

  parts[1].rotation.x = gcontrol.leftUpArm_x;
  parts[1].rotation.y = gcontrol.leftUpArm_y;
  parts[1].rotation.z = gcontrol.leftUpArm_z;

  parts[2].rotation.x = gcontrol.rightUpArm_x;
  parts[2].rotation.y = gcontrol.rightUpArm_y;
  parts[2].rotation.z = gcontrol.rightUpArm_z;

  parts[3].rotation.x = gcontrol.leftArm_x;
  parts[3].rotation.y = gcontrol.leftArm_y;
  parts[3].rotation.z = gcontrol.leftArm_z;

  parts[4].rotation.x = gcontrol.rightArm_x;
  parts[4].rotation.y = gcontrol.rightArm_y;
  parts[4].rotation.z = gcontrol.rightArm_z;

  parts[5].rotation.x = gcontrol.leftUpLeg_x;
  parts[5].rotation.y = gcontrol.leftUpLeg_y;
  parts[5].rotation.z = gcontrol.leftUpLeg_z;

  parts[6].rotation.x = gcontrol.rightUpLeg_x;
  parts[6].rotation.y = gcontrol.rightUpLeg_y;
  parts[6].rotation.z = gcontrol.rightUpLeg_z;

  parts[7].rotation.x = gcontrol.leftLeg_x;
  parts[7].rotation.y = gcontrol.leftLeg_y;
  parts[7].rotation.z = gcontrol.leftLeg_z;

  parts[8].rotation.x = gcontrol.rightLeg_x;
  parts[8].rotation.y = gcontrol.rightLeg_y;
  parts[8].rotation.z = gcontrol.rightLeg_z;
  //*/
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
  //sleep(3000);
}

/*//for keyboard control
function animate() {
  keyboard.update();

  if (keyboard.pressed('A')) {
    if (keyboard.pressed('shift'))
      parts[0].rotation.y += 0.01
    else
      parts[0].rotation.y -= 0.01
  }

  if (keyboard.pressed('B')) {
    if (keyboard.pressed('shift') && !keyboard.pressed('ctrl') && !keyboard.pressed('fn'))
      parts[1].rotation.y += 0.01
    else if (keyboard.pressed('Y'))
      parts[1].rotation.y -= 0.01
    if (keyboard.pressed('ctrl') && !keyboard.pressed('shift') && !keyboard.pressed('fn'))
      parts[1].rotation.x += 0.01
    else if (keyboard.pressed('X'))
      parts[1].rotation.x -= 0.01
    if (keyboard.pressed('alt') && !keyboard.pressed('shift') && !keyboard.pressed('ctrl'))
      parts[1].rotation.z += 0.01
    else if (keyboard.pressed('Z'))
      parts[1].rotation.z -= 0.01
  }
	
  if (keyboard.pressed('C')) {
    if (keyboard.pressed('shift') && !keyboard.pressed('ctrl') && !keyboard.pressed('fn'))
      parts[2].rotation.y += 0.01
    else if (keyboard.pressed('Y'))
      parts[2].rotation.y -= 0.01
    if (keyboard.pressed('ctrl') && !keyboard.pressed('shift') && !keyboard.pressed('fn'))
      parts[2].rotation.x += 0.01
    else if (keyboard.pressed('X'))
      parts[2].rotation.x -= 0.01
    if (keyboard.pressed('alt') && !keyboard.pressed('shift') && !keyboard.pressed('ctrl'))
      parts[2].rotation.z += 0.01
    else if (keyboard.pressed('Z'))
      parts[2].rotation.z -= 0.01
  }
  
  if (keyboard.pressed('D')) {
    if (keyboard.pressed('shift') && !keyboard.pressed('ctrl') && !keyboard.pressed('fn'))
      parts[3].rotation.y += 0.01
    else if (keyboard.pressed('Y'))
      parts[3].rotation.y -= 0.01
    if (keyboard.pressed('ctrl') && !keyboard.pressed('shift') && !keyboard.pressed('fn'))
      parts[3].rotation.x += 0.01
    else if (keyboard.pressed('X'))
      parts[3].rotation.x -= 0.01
    if (keyboard.pressed('alt') && !keyboard.pressed('shift') && !keyboard.pressed('ctrl'))
      parts[3].rotation.z += 0.01
    else if (keyboard.pressed('Z'))
      parts[3].rotation.z -= 0.01
  }
  
  
  if (keyboard.pressed('E')) {
    if (keyboard.pressed('shift') && !keyboard.pressed('ctrl') && !keyboard.pressed('fn'))
      parts[4].rotation.y += 0.01
    else if (keyboard.pressed('Y'))
      parts[4].rotation.y -= 0.01
    if (keyboard.pressed('ctrl') && !keyboard.pressed('shift') && !keyboard.pressed('fn'))
      parts[4].rotation.x += 0.01
    else if (keyboard.pressed('X'))
      parts[4].rotation.x -= 0.01
    if (keyboard.pressed('alt') && !keyboard.pressed('shift') && !keyboard.pressed('ctrl'))
      parts[4].rotation.z += 0.01
    else if (keyboard.pressed('Z'))
      parts[4].rotation.z -= 0.01
  }
  
  if (keyboard.pressed('F')) {
    if (keyboard.pressed('shift') && !keyboard.pressed('ctrl') && !keyboard.pressed('fn'))
      parts[5].rotation.y += 0.01
    else if (keyboard.pressed('Y'))
      parts[5].rotation.y -= 0.01
    if (keyboard.pressed('ctrl') && !keyboard.pressed('shift') && !keyboard.pressed('fn'))
      parts[5].rotation.x += 0.01
    else if (keyboard.pressed('X'))
      parts[5].rotation.x -= 0.01
    if (keyboard.pressed('alt') && !keyboard.pressed('shift') && !keyboard.pressed('ctrl'))
      parts[5].rotation.z += 0.01
    else if (keyboard.pressed('Z'))
      parts[5].rotation.z -= 0.01
  }
  if (keyboard.pressed('G')) {
    if (keyboard.pressed('shift') && !keyboard.pressed('ctrl') && !keyboard.pressed('fn'))
      parts[6].rotation.y += 0.01
    else if (keyboard.pressed('Y'))
      parts[6].rotation.y -= 0.01
    if (keyboard.pressed('ctrl') && !keyboard.pressed('shift') && !keyboard.pressed('fn'))
      parts[6].rotation.x += 0.01
    else if (keyboard.pressed('X'))
      parts[6].rotation.x -= 0.01
    if (keyboard.pressed('alt') && !keyboard.pressed('shift') && !keyboard.pressed('ctrl'))
      parts[6].rotation.z += 0.01
    else if (keyboard.pressed('Z'))
      parts[6].rotation.z -= 0.01
  }
  requestAnimationFrame(animate);
  render();
}

function render() {
  renderer.render(scene, camera);
}
*/
// important to add this 
// in jsfiddle!
window.focus();

</script>